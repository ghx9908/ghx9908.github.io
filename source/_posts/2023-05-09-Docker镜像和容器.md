---
title: Docker镜像和容器
author: 高红翔
date: 2023-05-09 18:24:35
categories: 前端运维
tags: docker
---

## 1. image 镜像

| 命令    | 含义                                             | 语法                                                                  | 案例                                              |
| :------ | :----------------------------------------------- | :-------------------------------------------------------------------- | :------------------------------------------------ |
| ls      | 查看全部镜像                                     | docker image ls                                                       |                                                   |
| search  | 查找镜像                                         | docker search [imageName]                                             |                                                   |
| history | 查看镜像历史                                     | docker history [imageName]                                            |                                                   |
| inspect | 显示一个或多个镜像详细信息                       | docker inspect [imageName]                                            |                                                   |
| pull    | 拉取镜像                                         | docker pull [imageName]                                               |                                                   |
| push    | 推送一个镜像到镜像仓库                           | docker push [imageName]                                               |                                                   |
| rmi     | 删除镜像                                         | docker rmi [imageName] docker image rmi 2                             |                                                   |
| prune   | 移除未使用的镜像，没有标记或补任何容器引用       | docker image prune                                                    | docker image prune                                |
| tag     | 标记本地镜像，将其归入某一仓库                   | docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG] | docker tag centos:7 zhangrenyang/centos:v1        |
| export  | 将容器文件系统作为一个 tar 归档文件导出到 STDOUT | docker export [OPTIONS] CONTAINER                                     | docker export -o hello-world.tar b2712f1067a3     |
| import  | 导入容器快照文件系统 tar 归档文件并创建镜像      | docker import [OPTIONS] file/URL/- [REPOSITORY[:TAG]]                 | docker import hello-world.tar                     |
| save    | 将指定镜像保存成`tar`文件                        | docker save [OPTIONS] IMAGE [IMAGE...]                                | docker save -o hello-world.tar hello-world:latest |
| load    | 加载 tar 文件并创建镜像                          |                                                                       | docker load -i hello-world.tar                    |
| build   | 根据 Dockerfile 构建镜像                         | docker build [OPTIONS] PATH / URL / -                                 | docker build -t zf/ubuntu:v1 .                    |

```bash

docker image ls #查看镜像
docker search ubuntu #查找镜像
docker  pull docker.io/hello-world # 拉取镜像
docker image pull  docker.io/hello-world # 拉取镜像
docker rmi  hello-world #  删除镜像
docker export -o [新输入镜像的名称] [容器ID]
```

## 2. container 容器

| 命令                 | 含义                                                                        | 语法                                                                       | 案例                                                |
| :------------------- | :-------------------------------------------------------------------------- | :------------------------------------------------------------------------- | --------------------------------------------------- |
| run                  | 从镜像运行一个容器                                                          | docker run ubuntu /bin/echo 'hello-world'                                  |                                                     |
| ls                   | 列出容器                                                                    | docker container ls                                                        |                                                     |
| inspect              | 显示一个或多个容器详细信息                                                  | docker inspect                                                             |                                                     |
| attach               | 要 attach 上去的容器必须正在运行，可以同时连接上同一个 container 来共享屏幕 | docker attach [OPTIONS] CONTAINER                                          | docker attach 6d1a25f95132                          |
| stats                | 显示容器资源使用统计                                                        | docker container stats                                                     |                                                     |
| top                  | 显示一个容器运行的进程                                                      | docker container top                                                       |                                                     |
| update               | 更新一个或多个容器配置                                                      |                                                                            | docker update -m 500m --memory-swap -1 6d1a25f95132 |
| port                 | 列出指定的容器的端口映射                                                    | docker run -d -p 8080:80 nginx docker container port containerID           |                                                     |
| ps                   | 查看当前运行的容器                                                          |                                                                            |                                                     |
| kill [containerId]   | 终止容器(发送 SIGKILL )                                                     | docker kill [containerId]                                                  |                                                     |
| rm [containerId]     | 删除容器                                                                    | docker rm [containerId]                                                    |                                                     |
| start [containerId]  | 启动已经生成、已经停止运行的容器文件                                        | docker start [containerId]                                                 |                                                     |
| stop [containerId]   | 终止容器运行 (发送 SIGTERM )                                                | docker stop [containerId] docker container stop $(docker container ps -aq) |                                                     |
| logs [containerId]   | 查看 docker 容器的输出                                                      | docker logs [containerId]                                                  |                                                     |
| exec [containerId]   | 进入一个正在运行的 docker 容器执行命令                                      | docker container exec -it f6a53629488b /bin/bash                           |                                                     |
| cp [containerId]     | 从正在运行的 Docker 容器里面，将文件拷贝到本机                              | docker container cp f6a53629488b:/root/root.txt .                          |                                                     |
| commit [containerId] | 根据一个现有容器创建一个新的镜像                                            | docker commit -a "zhufeng" -m "mynginx" a404c6c174a2 mynginx:v1            |                                                     |

命令解析

### 启动容器

```bash

docker run ubuntu /bin/echo "Hello world"
# Docker以ubuntu镜像创建一个新容器，然后在容器里执行 bin/echo "Hello world"，然后输出结果



# 查看容器
## -q, --quiet        Only display container IDs
docker ps # 查看当前运行的容器
docker ps -a #显示所有的容器，包括已停止的
docker ps -l #显示最新的那个容器


# 运行交互式的容器
## -t, --tty 在新容器内指定一个伪终端或终端。
## -i, --interactive 允许你对容器内的标准输入 (STDIN) 进行交互。
docker run -i -t ubuntu /bin/bash
exit


# 后台运行容器
## -d, --detach Run container in background and print container ID
docker run -d centos ping www.baidu.com
docker logs --follow [containerId]

# 杀死容器
## kill是不管容器同不同意，直接执行kill，强行终止；

docker kill [containerId]

# #删除容器
docker rm  [containerId] #删除容器
docker rmi [imageId]  #删除镜像
docker rm $(docker ps -a -q) # 删除所有容器

#启动容器
docker start [containerId]

# 停止容器
## stop，首先给容器发送一个TERM信号，让容器做一些退出前必须的保护性、安全性操作，然后让容器自动停止运行，如果在一段时间内，容器还是没有停止，再进行kill，强行终止
docker stop [containerId]

# 进入一个容器
docker attach [containerID]

#进入一个正在运行中的容器
docker exec -it [containerID] /bin/bash

#自动删除
docker run --rm ubuntu /bin/bash

# 查看 docker 容器的输出
## -f, --follow         Follow log outpu
docker logs [containerId]
docker logs -f [containerId]

```
